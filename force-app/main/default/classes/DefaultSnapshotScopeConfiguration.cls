public inherited sharing class DefaultSnapshotScopeConfiguration {

    private Id pipelineId;

    private static final List<String> SFDX_INCLUDED_METADATA = new List<String>{
        'AIApplication',
        'AIApplicationConfig',
        'AIAssistantTemplate',
        'AIReplyRecommendationsSettings',
        'AIScoringModelDefVersion',
        'AIScoringModelDefinition',
        'AIUsecaseDefinition',
        'AccessControlPolicy',
        'AccountForecastSettings',
        'AccountInsightsSettings',
        'AccountIntelligenceSettings',
        'AccountRelationshipShareRule',
        'AccountSettings',
        'AccountingFieldMapping',
        'AccountingModelConfig',
        'AccountingSettings',
        'AcctMgrTargetSettings',
        'ActionLauncherItemDef',
        'ActionLinkGroupTemplate',
        'ActionPlanTemplate',
        'ActionableListDefinition',
        'ActionsSettings',
        'ActivationPlatform',
        'ActivitiesSettings',
        'AddressSettings',
        'AdvAccountForecastSet',
        'AdvAcctForecastDimSource',
        'AdvAcctForecastPeriodGroup',
        'Ai4mSettings',
        'AnalyticSnapshot',
        'AnalyticsSettings',
        'AnimationRule',
        'ApexClass',
        'ApexComponent',
        'ApexEmailNotifications',
        'ApexPage',
        'ApexSettings',
        'ApexTestSuite',
        'ApexTrigger',
        'AppAnalyticsSettings',
        'AppExperienceSettings',
        'AppMenu',
        'ApplicationRecordTypeConfig',
        'ApplicationSubtypeDefinition',
        'AppointmentAssignmentPolicy',
        'AppointmentSchedulingPolicy',
        'ApprovalProcess',
        'AssessmentQuestion',
        'AssessmentQuestionSet',
        'AssignmentRules',
        'AssistantContextItem',
        'AssistantDefinition',
        'AssistantRecommendationType',
        'AssistantSkillQuickAction',
        'AssistantSkillSobjectAction',
        'AssistantVersion',
        'AssociationEngineSettings',
        'Audience',
        'AuraDefinitionBundle',
        'AuthProvider',
        'AutoResponseRules',
        'AutomatedContactsSettings',
        'BatchCalcJobDefinition',
        'BatchProcessJobDefinition',
        'BenefitAction',
        'BlacklistedConsumer',
        'BldgEnrgyIntensityCnfg',
        'BlockchainSettings',
        'Bot',
        'BotBlock',
        'BotSettings',
        'BotTemplate',
        'BotVersion',
        'BranchManagementSettings',
        'BrandingSet',
        'BriefcaseDefinition',
        'BusinessHoursSettings',
        'BusinessProcess',
        'BusinessProcessFeedbackConfiguration',
        'BusinessProcessGroup',
        'BusinessProcessTypeDefinition',
        'CMSConnectSource',
        'CallCenter',
        'CallCenterRoutingMap',
        'CallCoachingMediaProvider',
        'CallCtrAgentFavTrfrDest',
        'CampaignInfluenceModel',
        'CampaignSettings',
        'CanvasMetadata',
        'CareBenefitVerifySettings',
        'CareLimitType',
        'CareProviderAfflRoleConfig',
        'CareProviderSearchConfig',
        'CareRequestConfiguration',
        'CareSystemFieldMapping',
        'CaseSettings',
        'CaseSubjectParticle',
        'Certificate',
        'ChannelLayout',
        'ChannelObjectLinkingRule',
        'ChatterAnswersSettings',
        'ChatterEmailsMDSettings',
        'ChatterExtension',
        'ChatterSettings',
        'ClaimFinancialSettings',
        'ClaimMgmtFoundationEnabledSettings',
        'ClauseCatgConfiguration',
        'CleanDataService',
        'CodeBuilderSettings',
        'CollectionsDashboardSettings',
        'CommandAction',
        'CommerceSettings',
        'CommunitiesSettings',
        'Community',
        'CommunityTemplateDefinition',
        'CommunityThemeDefinition',
        'CompactLayout',
        'CompanySettings',
        'ConnectedApp',
        'ConnectedAppSettings',
        'ContentSettings',
        'ContextDefinition',
        'ContractSettings',
        'ConversationChannelDefinition',
        'ConversationVendorFieldDef',
        'ConversationVendorInfo',
        'ConversationalIntelligenceSettings',
        'CorsWhitelistOrigin',
        'CspTrustedSite',
        'CurrencySettings',
        'CustomAddressFieldSettings',
        'CustomApplication',
        'CustomApplicationComponent',
        'CustomDataType',
        'CustomExperience',
        'CustomFeedFilter',
        'CustomField',
        'CustomHelpMenuSection',
        'CustomIndex',
        'CustomLabels',
        'CustomMetadata',
        'CustomNotificationType',
        'CustomObject',
        'CustomObjectTranslation',
        'CustomPageWebLink',
        'CustomPermission',
        'CustomSite',
        'CustomTab',
        'CustomerDataPlatformSettings',
        'CustomizablePropensityScoringSettings',
        'DashboardFolder',
        'DataCalcInsightTemplate',
        'DataCategoryGroup',
        'DataConnectorIngestApi',
        'DataConnectorS3',
        'DataDotComSettings',
        'DataImportManagementSettings',
        'DataKitObjectTemplate',
        'DataPackageKitDefinition',
        'DataPackageKitObject',
        'DataPipeline',
        'DataSource',
        'DataSourceBundleDefinition',
        'DataSourceObject',
        'DataSourceTenant',
        'DataSrcDataModelFieldMap',
        'DataStreamDefinition',
        'DataStreamTemplate',
        'DataWeaveResource',
        'DecisionMatrixDefinition',
        'DecisionMatrixDefinitionVersion',
        'DecisionTable',
        'DecisionTableDatasetLink',
        'DelegateGroup',
        'DeploymentSettings',
        'DevHubSettings',
        'DigitalExperience',
        'DigitalExperienceBundle',
        'DigitalExperienceConfig',
        'DisclosureDefinition',
        'DisclosureDefinitionVersion',
        'DisclosureType',
        'DiscoveryAIModel',
        'DiscoveryGoal',
        'DiscoverySettings',
        'DiscoveryStory',
        'DocumentCategory',
        'DocumentCategoryDocumentType',
        'DocumentChecklistSettings',
        'DocumentFolder',
        'DocumentGenerationSetting',
        'DocumentType',
        'DuplicateRule',
        'DynamicFormsSettings',
        'DynamicTrigger',
        'EACSettings',
        'ESignatureConfig',
        'ESignatureEnvelopeConfig',
        'EclairGeoData',
        'EinsteinAgentSettings',
        'EinsteinAssistantSettings',
        'EinsteinDealInsightsSettings',
        'EinsteinDocumentCaptureSettings',
        'EmailAdministrationSettings',
        'EmailFolder',
        'EmailIntegrationSettings',
        'EmailServicesFunction',
        'EmailTemplateFolder',
        'EmailTemplateSettings',
        'EmbeddedServiceBranding',
        'EmbeddedServiceConfig',
        'EmbeddedServiceFieldService',
        'EmbeddedServiceFlowConfig',
        'EmbeddedServiceLiveAgent',
        'EmbeddedServiceMenuSettings',
        'EmployeeFieldAccessSettings',
        'EmployeeUserSettings',
        'EnhancedNotesSettings',
        'EntitlementProcess',
        'EntitlementSettings',
        'EntitlementTemplate',
        'EntityImplements',
        'EscalationRules',
        'EssentialsSettings',
        'EventDelivery',
        'EventRelayConfig',
        'EventSettings',
        'EventSubscription',
        'EventType',
        'ExperienceBundle',
        'ExperienceBundleSettings',
        'ExplainabilityActionDefinition',
        'ExplainabilityActionVersion',
        'ExplainabilityMsgTemplate',
        'ExpressionSetDefinition',
        'ExpressionSetDefinitionVersion',
        'ExpressionSetMessageToken',
        'ExpressionSetObjectAlias',
        'ExtDataTranObjectTemplate',
        'ExternalAIModel',
        'ExternalClientAppSettings',
        'ExternalClientApplication',
        'ExternalCredential',
        'ExternalDataConnector',
        'ExternalDataSource',
        'ExternalServiceRegistration',
        'ExtlClntAppConfigurablePolicies',
        'ExtlClntAppGlobalOauthSettings',
        'ExtlClntAppMobileConfigurablePolicies',
        'ExtlClntAppMobileSettings',
        'ExtlClntAppNotificationSettings',
        'ExtlClntAppOauthConfigurablePolicies',
        'ExtlClntAppOauthSettings',
        'ExtlClntAppSampleConfigurablePolicies',
        'ExtlClntAppSampleSettings',
        'FeatureParameterBoolean',
        'FeatureParameterDate',
        'FeatureParameterInteger',
        'FieldRestrictionRule',
        'FieldServiceMobileExtension',
        'FieldServiceSettings',
        'FieldSet',
        'FieldSrcTrgtRelationship',
        'FileUploadAndDownloadSecuritySettings',
        'FilesConnectSettings',
        'FlexiPage',
        'Flow',
        'FlowCategory',
        'FlowDefinition',
        'FlowSettings',
        'FlowTest',
        'ForecastingFilter',
        'ForecastingFilterCondition',
        'ForecastingObjectListSettings',
        'ForecastingSettings',
        'ForecastingSourceDefinition',
        'ForecastingType',
        'ForecastingTypeSource',
        'Form',
        'FormulaSettings',
        'FuelType',
        'FuelTypeSustnUom',
        'FunctionReference',
        'FundraisingConfig',
        'GatewayProviderPaymentMethodType',
        'GenAiPromptTemplate',
        'GenAiPromptTemplateActv',
        'GlobalPicklist',
        'GlobalValueSet',
        'GlobalValueSetTranslation',
        'GoogleAppsSettings',
        'Group',
        'HighVelocitySalesSettings',
        'HomePageComponent',
        'HomePageLayout',
        'IPAddressRange',
        'Icon',
        'IdeasSettings',
        'IdentityProviderSettings',
        'IdentityVerificationProcDef',
        'IframeWhiteListUrlSettings',
        'InboundCertificate',
        'InboundNetworkConnection',
        'IncidentMgmtSettings',
        'IncludeEstTaxInQuoteSettings',
        'Index',
        'IndustriesAutomotiveSettings',
        'IndustriesEinsteinFeatureSettings',
        'IndustriesLoyaltySettings',
        'IndustriesManufacturingSettings',
        'IndustriesSettings',
        'InsightType',
        'InstalledPackage',
        'IntegrationHubSettings',
        'IntegrationHubSettingsType',
        'IntegrationProviderDef',
        'InterestTaggingSettings',
        'InternalDataConnector',
        'InternalOrganization',
        'InvLatePymntRiskCalcSettings',
        'InventorySettings',
        'InvocableActionSettings',
        'IoTSettings',
        'KeywordList',
        'KnowledgeSettings',
        'LanguageSettings',
        'Layout',
        'LeadConfigSettings',
        'LeadConvertSettings',
        'Letterhead',
        'LicenseDefinition',
        'LicensingSettings',
        'LightningBolt',
        'LightningComponentBundle',
        'LightningExperienceSettings',
        'LightningExperienceTheme',
        'LightningMessageChannel',
        'LightningOnboardingConfig',
        'ListView',
        'LiveAgentSettings',
        'LiveChatAgentConfig',
        'LiveChatButton',
        'LiveChatDeployment',
        'LiveChatSensitiveDataRule',
        'LiveMessageSettings',
        'LocationUse',
        'LoyaltyProgramSetup',
        'MLDataDefinition',
        'MLPredictionDefinition',
        'MLRecommendationDefinition',
        'MacroSettings',
        'MailMergeSettings',
        'ManagedContentType',
        'ManagedTopics',
        'MapsAndLocationSettings',
        'MarketSegmentDefinition',
        'MarketingAppExtension',
        'MarketingResourceType',
        'MatchingRules',
        'MediaAdSalesSettings',
        'MeetingsSettings',
        'MessagingChannel',
        'MfgProgramTemplate',
        'MfgServiceConsoleSettings',
        'MilestoneType',
        'MktCalcInsightObjectDef',
        'MktDataTranObject',
        'MlDomain',
        'MobSecurityCertPinConfig',
        'MobileApplicationDetail',
        'MobileSecurityAssignment',
        'MobileSecurityPolicy',
        'MobileSecurityPolicySet',
        'MobileSettings',
        'ModerationRule',
        'MutingPermissionSet',
        'MyDomainDiscoverableLogin',
        'MyDomainSettings',
        'NameSettings',
        'NamedCredential',
        'NavigationMenu',
        'Network',
        'NetworkBranding',
        'NotificationTypeConfig',
        'NotificationsSettings',
        'OauthCustomScope',
        'OauthOidcSettings',
        'ObjectHierarchyRelationship',
        'ObjectLinkingSettings',
        'ObjectSourceTargetMap',
        'OcrSampleDocument',
        'OcrTemplate',
        'OmniChannelPricingSettings',
        'OmniChannelSettings',
        'OmniDataTransform',
        'OmniIntegrationProcedure',
        'OmniInteractionAccessConfig',
        'OmniInteractionConfig',
        'OmniScript',
        'OmniSupervisorConfig',
        'OmniUiCard',
        'OnlineSalesSettings',
        'OpportunityInsightsSettings',
        'OpportunityScoreSettings',
        'OpportunitySettings',
        'Orchestration',
        'OrchestrationContext',
        'OrderManagementSettings',
        'OrderSettings',
        'OrgSettings',
        'OutboundNetworkConnection',
        'PardotEinsteinSettings',
        'PardotSettings',
        'ParticipantRole',
        'PartyDataModelSettings',
        'PathAssistant',
        'PathAssistantSettings',
        'PaymentGatewayProvider',
        'PaymentsManagementEnabledSettings',
        'PaymentsSettings',
        'PermissionSet',
        'PermissionSetGroup',
        'PermissionSetLicenseDefinition',
        'PersonAccountOwnerPowerUser',
        'PicklistSettings',
        'PipelineInspMetricConfig',
        'PlatformCachePartition',
        'PlatformEventChannel',
        'PlatformEventChannelMember',
        'PlatformEventSettings',
        'PlatformEventSubscriberConfig',
        'PlatformSlackSettings',
        'Portal',
        'PortalsSettings',
        'PostTemplate',
        'PredictionBuilderSettings',
        'PresenceDeclineReason',
        'PresenceUserConfig',
        'PricingRecipe',
        'PrivacySettings',
        'ProcessFlowMigration',
        'ProductAttributeSet',
        'ProductSettings',
        'ProductSpecificationTypeDefinition',
        'ProfilePasswordPolicy',
        'ProfileSessionSetting',
        'Prompt',
        'Queue',
        'QueueRoutingConfig',
        'QuickAction',
        'QuickTextSettings',
        'QuoteSettings',
        'RealTimeEventSettings',
        'RecommendationBuilderSettings',
        'RecommendationStrategy',
        'RecordActionDeployment',
        'RecordAggregationDefinition',
        'RecordAlertCategory',
        'RecordAlertDataSource',
        'RecordPageSettings',
        'RecordType',
        'RedirectWhitelistUrl',
        'RegisteredExternalService',
        'RelationshipGraphDefinition',
        'RemoteSiteSetting',
        'ReportFolder',
        'ReportType',
        'RestrictionRule',
        'RetailExecutionSettings',
        'Role',
        'SalesAgreementSettings',
        'SalesWorkQueueSettings',
        'SamlSsoConfig',
        'SandboxSettings',
        'SchedulingObjective',
        'SchedulingRule',
        'SchemaSettings',
        'Scontrol',
        'ScoreCategory',
        'SearchCriteriaConfiguration',
        'SearchSettings',
        'SearchableObjDataSyncInfo',
        'SecuritySettings',
        'ServiceAISetupDefinition',
        'ServiceAISetupField',
        'ServiceChannel',
        'ServiceCloudVoiceSettings',
        'ServicePresenceStatus',
        'ServiceProcess',
        'ServiceSetupAssistantSettings',
        'Settings',
        'SharingCriteriaRule',
        'SharingGuestRule',
        'SharingOwnerRule',
        'SharingReason',
        'SharingRules',
        'SharingSet',
        'SharingSettings',
        'SharingTerritoryRule',
        'SiteDotCom',
        'SiteSettings',
        'Skill',
        'SkillType',
        'SlackApp',
        'SocialCustomerServiceSettings',
        'SocialProfileSettings',
        'SourceTrackingSettings',
        'StandardValueSet',
        'StandardValueSetTranslation',
        'StnryAssetEnvSrcCnfg',
        'StreamingAppDataConnector',
        'SubscriptionManagementSettings',
        'SurveySettings',
        'SustainabilityUom',
        'SustnUomConversion',
        'SvcCatalogCategory',
        'SvcCatalogFilterCondition',
        'SvcCatalogFilterCriteria',
        'SvcCatalogFulfillmentFlow',
        'SvcCatalogItemDef',
        'SvcCatalogItemDefFiltrCrit',
        'SynonymDictionary',
        'SystemNotificationSettings',
        'Territory',
        'Territory2',
        'Territory2Model',
        'Territory2Rule',
        'Territory2Settings',
        'Territory2Type',
        'TimeSheetTemplate',
        'TimelineObjectDefinition',
        'TopicsForObjects',
        'TrailheadSettings',
        'TransactionSecurityPolicy',
        'Translations',
        'TrialOrgSettings',
        'UIObjectRelationConfig',
        'UiPlugin',
        'UiViewDefinition',
        'UserAuthCertificate',
        'UserCriteria',
        'UserEngagementSettings',
        'UserInterfaceSettings',
        'UserManagementSettings',
        'UserProfileSearchScope',
        'UserProvisioningConfig',
        'ValidationRule',
        'VehicleAssetEmssnSrcCnfg',
        'ViewDefinition',
        'VisualizationPlugin',
        'VoiceSettings',
        'WarrantyLifecycleMgmtSettings',
        'WaveApplication',
        'WaveComponent',
        'WaveDashboard',
        'WaveDataflow',
        'WaveDataset',
        'WaveLens',
        'WaveRecipe',
        'WaveTemplateBundle',
        'WaveXmd',
        'Web3Settings',
        'WebLink',
        'WebStoreBundle',
        'WebStoreTemplate',
        'WebToXSettings',
        'WorkDotComSettings',
        'WorkSkillRouting',
        'Workflow',
        'WorkflowAlert',
        'WorkflowFieldUpdate',
        'WorkflowKnowledgePublish',
        'WorkflowOutboundMessage',
        'WorkflowRule',
        'WorkflowSend',
        'WorkflowTask',
        'WorkforceEngagementSettings',
        'XOrgHub'
    };

    private static final List<String> SFDX_EXCLUDED_METADATA = new List<String>{
        'ContentAsset',
        'Dashboard',
        'Document',
        'EmailTemplate',
        'Profile',
        'Report',
        'StaticResource'
    };

    private static final List<String> VLOCITY_INCLUDED_METADATA = new List<String>{
        'Attachment',
        'AttributeAssignmentRule',
        'AttributeCategory',
        'CalculationMatrix',
        'CalculationMatrixVersion',
        'CalculationProcedure',
        'CalculationProcedureVersion',
        'Catalog',
        'ChargeMeasurement',
        'ContentVersion',
        'ContextAction',
        'ContextDimension',
        'ContextScope',
        'ContractType',
        'CpqConfigurationSetup',
        'CustomFieldMap',
        'CustomObjectMap',
        'DecisionMatrix',
        'DecisionMatrixVersion',
        'DataRaptor',
        'Document',
        'DocumentClause',
        'DocumentTemplate',
        'DocumentTemplates',
        'EntityFilter',
        'ExpressionSet',
        'ExpressionSetVersion',
        'FlexCard',
        'GeneralSettings',
        'IntegrationProcedure',
        'IntegrationProcedureVersion',
        'IntegrationRetryPolicy',
        'InterfaceImplementation',
        'ItemImplementation',
        'ManualQueue',
        'ObjectClass',
        'ObjectContextRule',
        'ObjectLayout',
        'OfferMigrationPlan',
        'OmniScript',
        'OmniScriptVersion',
        'OfferMigrationPlan',
        'OrchestrationDependencyDefinition',
        'OrchestrationItemDefinition',
        'OrchestrationPlanDefinition',
        'OrchestrationQueueAssignmentRule',
        'Pricebook2',
        'PriceList',
        'PricingPlan',
        'PricingVariable',
        'Product2',
        'ProductAttributes',
        'ProductConfiguration',
        'ProductDecomposition',
        'ProductHierarchy',
        'ProductPricing',
        'Project',
        'Promotion',
        'QueryBuilder',
        'RateBand',
        'RelationshipGraph',
        'SpecTemplateMapping',
        'Rule',
        'StoryObjectConfiguration',
        'String',
        'System',
        'ThorOrchestrationQueue',
        'TimePlan',
        'TimePolicy',
        'UIFacet',
        'UISection',
        'VlocityAction',
        'VlocityAttachment',
        'VlocityCard',
        'VlocityDataStore',
        'VlocityFunction',
        'VlocityPicklist',
        'VlocityScheduledJob',
        'VlocitySearchWidgetSetup',
        'VlocityStateModel',
        'VlocityUILayout',
        'VlocityUITemplate',
        'VlocityWebTrackingConfiguration',
        'VlocityTrackingGroup',
        'VqMachine',
        'VqResource'
    };

    private static final List<String> VLOCITY_EXCLUDED_METADATA = new List<String>{};

    public DefaultSnapshotScopeConfiguration(Id pipelineId) {
        this.pipelineId = pipelineId;
    }

    // PUBLIC

    public String generate() {
        Map<String, MetadataScope> metadataScopeByTechnology = new Map<String, MetadataScope>();

        metadataScopeByTechnology.put('Vlocity', CheckVlocityEnabled.execute(pipelineId) ?
                                       new MetadataScope(VLOCITY_INCLUDED_METADATA, VLOCITY_EXCLUDED_METADATA) :
                                       null);
        metadataScopeByTechnology.put('SFDX', new MetadataScope(SFDX_INCLUDED_METADATA, SFDX_EXCLUDED_METADATA));

        return JSON.serialize(metadataScopeByTechnology);
    }

    // INNER
    private class MetadataScope {
        public List<String> included;
        public List<String> excluded;

        public MetadataScope(List<String> included, List<String> excluded) {
            this.included = included;
            this.excluded = excluded;
        }
    }
}